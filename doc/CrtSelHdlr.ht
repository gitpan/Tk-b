<HTML>
<! Copyright (c) 1990-1994 The Regents of the University of California.-->
<! Copyright (c) 1994 Sun Microsystems, Inc.-->
<! See the file "license.terms" for information on usage and redistribution-->
<! of this file, and for a DISCLAIMER OF ALL WARRANTIES.-->
<! -->
<! @(#) CrtSelHdlr.3 1.12 95/05/06 15:29:17-->
<! -->
<H1>Tk_CreateSelHandler</H1>
<HR>
<A NAME=NAME><H2>NAME</H2>
</A>Tk_CreateSelHandler, Tk_DeleteSelHandler - arrange to handle requests for a selection
<A NAME=SYNOPSIS><H2>SYNOPSIS</H2>
</A><BR>
<B>#include &lt;tk.h&gt;</B><BR>
<P>
<B>Tk_CreateSelHandler</B>(<I>tkwin, selection, target, proc, clientData, format</I>)<BR>
<P>
<B>Tk_DeleteSelHandler</B>(<I>tkwin, selection, target</I>)<BR>
<A NAME=ARGUMENTS><H2>ARGUMENTS</H2>
</A><DL>
<DT><CODE>Tk_Window tkwin</CODE>
(in) <DD>Window for which <I>proc</I> will provide selection information.<BR>
<DT><CODE>Atom selection</CODE>
(in) <DD>The name of the selection for which <I>proc</I> will provide<BR>
selection information.<BR>
<DT><CODE>Atom target</CODE>
(in) <DD>Form in which <I>proc</I> can provide the selection (e.g. STRING<BR>
or FILE_NAME).  Corresponds to <I>type</I> arguments in <B>selection</B><BR>
commands.<BR>
<DT><CODE>Tk_SelectionProc *proc</CODE>
(in) <DD>Procedure to invoke whenever the selection is owned by <I>tkwin</I><BR>
and the selection contents are requested in the format given by<BR>
<I>target</I>.<BR>
<DT><CODE>ClientData clientData</CODE>
(in) <DD>Arbitrary one-word value to pass to <I>proc</I>.<BR>
<DT><CODE>Atom format</CODE>
(in) <DD>If the selection requestor isn't in this process, <I>format</I> determines<BR>
the representation used to transmit the selection to its<BR>
requestor.<BR>
</DL>
<HR>
<BR>
<A NAME=DESCRIPTION><H2>DESCRIPTION</H2>
</A><P>
<B>Tk_CreateSelHandler</B> arranges for a particular procedure<BR>
(<I>proc</I>) to be called whenever <I>selection</I> is owned by<BR>
<I>tkwin</I> and the selection contents are requested in the<BR>
form given by <I>target</I>. <BR>
<I>Target</I> should be one of<BR>
the entries defined in the left column of Table 2 of the<BR>
X Inter-Client Communication Conventions Manual (ICCCM) or<BR>
any other form in which an application is willing to present<BR>
the selection.  The most common form is STRING.<BR>
<P>
<I>Proc</I> should have arguments and result that match the<BR>
type <B>Tk_SelectionProc</B>:<BR>
<BR>
<DL>
typedef int Tk_SelectionProc(<BR>
<DL>
ClientData <I>clientData</I>,<BR>
int <I>offset</I>,<BR>
char *<I>buffer</I>,<BR>
int <I>maxBytes</I>);<BR>
</DL>
</DL>
<BR>
The <I>clientData</I> parameter to <I>proc</I> is a copy of the
<I>clientData</I> argument given to <B>Tk_CreateSelHandler</B>.
Typically, <I>clientData</I> points to a data
structure containing application-specific information that is
needed to retrieve the selection.  <I>Offset</I> specifies an
offset position into the selection, <I>buffer</I> specifies a
location at which to copy information about the selection, and
<I>maxBytes</I> specifies the amount of space available at
<I>buffer</I>.  <I>Proc</I> should place a NULL-terminated string
at <I>buffer</I> containing <I>maxBytes</I> or fewer characters
(not including the terminating NULL), and it should return a
count of the number of non-NULL characters stored at
<I>buffer</I>.  If the selection no longer exists (e.g. it once
existed but the user deleted the range of characters containing
it), then <I>proc</I> should return -1.
<P>
When transferring large selections, Tk will break them up into
smaller pieces (typically a few thousand bytes each) for more
efficient transmission.  It will do this by calling <I>proc</I>
one or more times, using successively higher values of <I>offset</I>
to retrieve successive portions of the selection.  If <I>proc</I>
returns a count less than <I>maxBytes</I> it means that the entire
remainder of the selection has been returned.  If <I>proc</I>'s return
value is <I>maxBytes</I> it means there may be additional information
in the selection, so Tk must make another call to <I>proc</I> to
retrieve the next portion.
<P>
<I>Proc</I> always returns selection information in the form of a
character string.  However, the ICCCM allows for information to
be transmitted from the selection owner to the selection requestor
in any of several formats, such as a string, an array of atoms, an
array of integers, etc.  The <I>format</I> argument to
<B>Tk_CreateSelHandler</B> indicates what format should be used to
transmit the selection to its requestor (see the middle column of
Table 2 of the ICCCM for examples).  If <I>format</I> is not
STRING, then Tk will take the value returned by <I>proc</I> and divided
it into fields separated by white space.  If <I>format</I> is ATOM,
then Tk will return the selection as an array of atoms, with each
field in <I>proc</I>'s result treated as the name of one atom.  For
any other value of <I>format</I>, Tk will return the selection as an
array of 32-bit values where each field of <I>proc</I>'s result is
treated as a number and translated to a 32-bit value.  In any event,
the <I>format</I> atom is returned to the selection requestor along
with the contents of the selection.
<P>
If <B>Tk_CreateSelHandler</B> is called when there already exists a
handler for <I>selection</I> and <I>target</I> on <I>tkwin</I>, then the
existing handler is replaced with a new one.
<P>
<B>Tk_DeleteSelHandler</B> removes the handler given by <I>tkwin</I>,
<I>selection</I>, and <I>target</I>, if such a handler exists.
If there is no such handler then it has no effect.

<A NAME=KEYWORDS><H2>KEYWORDS</H2>
</A>format, handler, selection, target
